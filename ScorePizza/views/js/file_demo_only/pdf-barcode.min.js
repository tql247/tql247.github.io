var PDFJS=pdfjsLib,PDFBarcodeJs=function(){var e="PROD";function t(e){var t=function(e,t){for(var a in t)t.hasOwnProperty(a)&&(e[a]=t[a]);return e}({},{scale:{once:!0,value:3,start:3,step:.6,stop:4.8},resultOpts:{singleCodeInPage:!1,multiCodesInPage:!0,maxCodesInPage:1},patches:["x-small","small","medium"],improve:!0,noisify:!0,quagga:{inputStream:{},locator:{halfSample:!1},decoder:{readers:["code_128_reader"],multiple:!0},locate:!0}});return function(e){!e.resultOpts.multiCodesInPage||e.resultOpts.singleCodeInPage?(e.resultOpts.maxCodesInPage=1,e.quagga.decoder.multiple=!1):e.quagga.decoder.multiple=!0;if(e.scale.once){var t=parseFloat(e.scale.value.toFixed(2));e.scale.start=t,e.scale.stop=t,e.scale.step=1,e.scale.ordered=[t]}else{e.scale.ordered=[];var a=e.scale.start;for(a=e.scale.start;a<=e.scale.stop;a+=e.scale.step)a=parseFloat(a.toFixed(2)),e.scale.ordered.push(a)}}(t=function e(t,a){for(var o in a)try{a[o].constructor==Object?t[o]=e(t[o],a[o]):t[o]=a[o]}catch(e){t[o]=a[o]}return t}(t,e)),t}function a(e){var t=document.createElement("canvas");return t.width=e.width,t.height=e.height,t}function o(t,a,o){return"DEV"===e&&(console.log("Configs for patch : "+a),console.log(o)),o.inputStream.size=t.width,o.locator.patchSize=a,o.src=t.toDataURL("image/jpeg"),o}function s(t,a,o,s,n){"DEV"===e&&console.log("Adding "+t.code),a.codes.push(t.code),a.codesDetailed.push({code:t.code,format:t.format,page:o,scale:n}),a.codesByPage[o].push(t.code),void 0===a.codesByPageAndFormat[o][t.format]?a.codesByPageAndFormat[o][t.format]=[t.code]:a.codesByPageAndFormat[o][t.format].push(t.code),void 0===a.codesByFormat[t.format]?a.codesByFormat[t.format]=[t.code]:a.codesByFormat[t.format].push(t.code),a.statsByPage[o].totalOnPatch[s]+=1,a.statsByPage[o].totalOnScale[n]+=1,a.stats.totalOnPatch[s]+=1,a.stats.totalOnScale[n]+=1}function n(t,a,o){"DEV"===e&&(console.log(o+" order before smart shuffle"),console.log(t),console.log("Applying smart shuffle..."));var s=t.indexOf(a);if(-1===s)return t;var n=[],r=t.length,c=s,l=s;for(n.push(a);n.length!==r;)l++,--c>=0&&n.push(t[c]),l<r&&n.push(t[l]);return"DEV"===e&&(console.log(o+" order after shuffle..."),console.log(n)),n}function r(r){var c={codes:[],codesDetailed:[],codesByPage:[],codesByFormat:[],codesByPageAndFormat:[],stats:{totalOnPatch:[],totalOnScale:[]},statsByPage:[],success:!1},l=t(r.configs);"DEV"===e&&(console.log("Initial settings..."),console.log(l));var i=1,g=function(e,t){var a,o,s;if("object"!=typeof e||null===e)return a=e;for(o in a=new e.constructor,e)e.hasOwnProperty(o)&&(s=typeof e[o],t&&"object"==s&&null!==e[o]?a[o]=this.copyobj(e[o]):a[o]=e[o]);return a}(l.quagga),d=URL.createObjectURL(r.input.files[0]);PDFJS.disableWorker=!0,PDFJS.getDocument(d).promise.then(function(t){if(r.singlePage){if(!function(e,t){return t>=1&&t<=e.numPages}(t,r.pageNr))return r.final_call_back({success:!1,message:"Given page is out of range! Valid page range is (1-"+t.numPages+")"}),!1;i=r.pageNr}!function d(){"DEV"===e&&console.log("PAGE_"+i+" fetched...");t.getPage(i).then(async function(u){"DEV"===e&&console.log("PAGE_"+i+" rendered..."),function(e,t,a){a.codesByPage[e]=[],a.codesByPageAndFormat[e]=[],a.statsByPage[e]={totalOnPatch:[],totalOnScale:[]};for(var o=t.patches.length,s=0;s<o;s++)a.statsByPage[e].totalOnPatch[t.patches[s]]=0,a.stats.totalOnPatch.hasOwnProperty(t.patches[s])||(a.stats.totalOnPatch[t.patches[s]]=0);for(var n=t.scale.ordered.length,r=0;r<n;r++)a.statsByPage[e].totalOnScale[t.scale.ordered[r]]=0,a.stats.totalOnScale.hasOwnProperty(t.scale.ordered[r])||(a.stats.totalOnScale[t.scale.ordered[r]]=0)}(i,l,c);for(var h=function(t,a,n){return new Promise(d=>{var u=function(e,t,a){var o={},s=e.getContext("2d").getImageData(0,0,e.width,e.height);if(1===t){var n=document.createElement("canvas");n.width=e.width,n.height=e.height,n.getContext("2d").putImageData(s,0,0),o.printImg=n}var r=document.createElement("canvas");r.width=e.width,r.height=e.height;var c=r.getContext("2d");if(c.putImageData(s,0,0),a)for(var l=0;l<e.height;l+=60){for(var i=c.getImageData(0,l,e.width,1).data,g=!0,d=0,u=i.length;d<u;d+=4)if(255!==i[d]){g=!1;break}g&&(c.beginPath(),c.moveTo(0,l),c.lineTo(e.width,l),c.lineWidth=2,c.strokeStyle="red",c.stroke())}return o.processImg=r,o}(t,n,l.noisify),h=0,f=function(e,t){function a(e,t,a){function o(e){var t,a=[],o=[];for(t=1;t<Math.sqrt(e)+1;t++)e%t==0&&(o.push(t),t!==e/t&&a.unshift(Math.floor(e/t)));return o.concat(a)}var s={};s=a?{x:e.width/2,y:e.height/2}:{x:e.width,y:e.height};var n=function(e,t){var a,s=o(t.x),n=o(t.y),r=Math.max(t.x,t.y),c=function(e,t){var a=0,o=0,s=[];for(;a<e.length&&o<t.length;)e[a]===t[o]?(s.push(e[a]),a++,o++):e[a]>t[o]?o++:a++;return s}(s,n),l=[8,10,15,20,32,60,80],i={"x-small":5,small:4,medium:3,large:2,"x-large":1},g=i[e]||i.medium,d=l[g],u=Math.floor(r/d);function h(e){for(var t=0,a=e[Math.floor(e.length/2)];t<e.length-1&&e[t]<u;)t++;return t>0&&(a=Math.abs(e[t]-u)>Math.abs(e[t-1]-u)?e[t-1]:e[t]),u/a<l[g+1]/l[g]&&u/a>l[g-1]/l[g]?{x:a,y:a}:null}(a=h(c))||(a=h(o(r)))||(a=h(o(u*d)));return a}(t,s);return!(n.x*n.y*3>65536||n.x*n.y*3+n.x*n.y>65536)}for(var o=[],s=t.patches.length,n=0;n<s;n++)a(e,t.patches[n],t.quagga.locator.halfSample)&&o.push(t.patches[n]);return o}(u.processImg,l),p=function(t){return function(t,a,o,n,r,c){if(c.resultOpts.singleCodeInPage)t&&t.codeResult?("DEV"===e&&console.log("PAGE_"+o+" has results when scaled "+r+" times with "+n+" patch."),s(t.codeResult,a,o,n,r)):"DEV"===e&&console.log("PAGE_"+o+" when scaled "+r+" times with "+n+" patch has no results.");else{var l=!1;if(t)for(var i=0;i<t.length;i++)if(t[i].codeResult){"DEV"!==e||l||(l=!0,console.log("PAGE_"+o+" when scaled "+r+"  times with "+n+" patch has no results."));var g=t[i].codeResult,d=a.codesByPageAndFormat[o][g.format];if(void 0!==d&&-1!==d.indexOf(g.code))continue;if(a.codesByPage[o].length===c.resultOpts.maxCodesInPage)break;s(g,a,o,n,r)}l||"DEV"===e&&console.log("PAGE_"+o+" when scaled "+r+" times with "+n+" patch has no results.")}}(t,c,i,f[h],a,l),c.codesByPage[i].length<l.resultOpts.maxCodesInPage?++h<f.length?(Quagga.decodeSingle(o(u.processImg,f[h],g),p),!1):d({isDone:!1,message:"PAGE_"+i+" | Max number of tries (with valid patches) to find a barcode on page was reached!"}):d({isDone:!0,patch:f[h],message:"PAGE_"+i+" | Count of barcodes requested was reached!"})};if(void 0!==r.page_printer&&1===n&&r.page_printer(u.printImg,i,a),!(f.length>0))return d({isDone:!1,message:"No valid patch was found!"});Quagga.decodeSingle(o(u.processImg,f[h],g),p)})},f=l.scale.ordered.length,p=0;p<f;p++){const t=l.scale.ordered[p],o=u.getViewport({scale:t}),s=a(o),r=p+1;"DEV"===e&&console.log("PAGE_"+i+" scaling "+t+" times.");var m=await u.render({canvasContext:s.getContext("2d"),viewport:o}).promise.then(()=>h(s,t,r));if(m.isDone){"DEV"===e&&console.log("PAGE_ "+i+" was finished! Stopping the loop of scale! (on scale "+t+")"),l.improve&&(l.patches=n(l.patches,m.patch,"Patch"),l.scale.ordered=n(l.scale.ordered,t,"Scale"));break}"DEV"===e&&console.log(m)}!r.singlePage&&i<t.numPages?(i++,d()):r.final_call_back(function(e,t){return e.success=!0,t.singlePage&&(delete e.codesByPage,delete e.statsByPage,delete e.codesByPageAndFormat,e.decodedPage=t.pageNr),e}(c,r))})}()},function(e){r.final_call_back({success:!1,message:e.message})})}return{decodeDocument:function(e,t,a,o){r({input:e,singlePage:!1,configs:t,final_call_back:a,page_printer:o})},decodeSinglePage:function(e,t,a,o,s){r({input:e,singlePage:!0,pageNr:t,configs:a,final_call_back:o,page_printer:s})}}}();